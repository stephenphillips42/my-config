## General Configuration Stuff #########################################
  
# ::sigh::
run-shell "tmux setenv -g TMUX_VERSION $(tmux -V | cut -c 6- | cut -d- -f1)"

# use UTF-8 (::sigh::)
if-shell -b '[ "$(echo "$TMUX_VERSION < 2.2" | bc)" = 1 ]' \
    "set -g utf8 ; set-window-option -g utf8 on"

# use tmux in 256 color mode
set -g default-terminal "tmux-256color"

# short command delay
set -sg escape-time 1

# for reloading conf in tmux
bind R source-file ~/.tmux.conf \; display "reloaded ~/.tmux.conf"

# set window and pane index to 1 (0 by default)
set-option -g base-index 1
setw -g pane-base-index 1


## Keyboard Bindings ###################################################

# use Ctrl+a -- like GNU screen
set -g prefix C-a
unbind C-b

# use vi style keys for copy mode
# I am also keeping the GNU screen style binding [ in
# addition to adding ^ESC since hold habits are hard to kill
setw -g mode-keys vi
bind Escape copy-mode
# unbind P
bind P paste-buffer

# ::sigh::
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection

# These are for copying the tmux copy buffer
# to the xclipboard. Y is causing some tmux
# freezing up issues and needs some work...
#------------------------------------------------------
# move tmux copy buffer into x clipboard
bind y run "tmux save-buffer - | xclip -i;"
# move x clipboard into tmux paste buffer
unbind i
bind i run "xclip -o | tmux load-buffer - ; tmux paste-buffer"
#------------------------------------------------------

# make Ctrl+left / Ctrl+right work properly @ prompt
set-window-option -g xterm-keys on

bind-key ` command-prompt -p "session name:"  "rename-session '%%'"
################################ Personal ##############################
bind C-p previous-window
bind C-n next-window
################################ End Personal ##########################
## Window Management ###################################################
# use GNU screen behavior for switching to previous window
bind C-a last-window
# move window to specified index
bind-key m command-prompt -p "Move window to:"  "move-window -t '%%'"
# swap window index with another window
bind-key s command-prompt -p "Swap window with:"  "swap-window -t '%%'"
# rename a window
bind-key '"' command-prompt -p "Rename window:"  "rename-window '%%'"
# reorder open windows to remove index gaps
bind r move-window -r\; display-message "Windows Reordered"
# more intuitive bindings for splitting a window
bind | split-window -h
bind - split-window -v
## Pane Management #####################################################
# break focused pane out into a new window
bind-key ! break-pane -d
# join focused window to target window as a pane
bind-key @ command-prompt -p "join to window:" "join-pane -t '%%'"
# navigate panes using h/j/k/l
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
# resize panes using H/J/K/L
bind H resize-pane -L 5
bind J resize-pane -D 5
bind K resize-pane -U 5
bind L resize-pane -R 5
## Status Bar Stuff ####################################################
# /usr/local/google/home/chengduscp/.tmux.conf:115: invalid option: status-attr
# /usr/local/google/home/chengduscp/.tmux.conf:119: invalid option: window-status-fg
# /usr/local/google/home/chengduscp/.tmux.conf:120: invalid option: window-status-attr
# /usr/local/google/home/chengduscp/.tmux.conf:124: invalid option: window-status-current-fg
# /usr/local/google/home/chengduscp/.tmux.conf:125: invalid option: window-status-current-bg
# /usr/local/google/home/chengduscp/.tmux.conf:126: invalid option: window-status-current-attr
# /usr/local/google/home/chengduscp/.tmux.conf:130: invalid option: pane-border-fg
# /usr/local/google/home/chengduscp/.tmux.conf:134: invalid option: message-bg
# set -g status-left "#h"
# set -g status-left "#S"
set -g status-left ""
# default statusbar colors
set-option -g status-style bg=colour235,fg=white,default #bg=base02
# window title colors
set -g window-style fg=colour244,bg=default,bright #fg=base0
# active window title colors
set-window-option -g window-status-current-format "[#I:#W#F]"
set-window-option -g window-status-current-style fg=colour11,bg=default,bright
# pane border
set -g pane-border-style fg=colour235 #fg=base02
set -g pane-active-border-style fg=blue
# message text
set -g message-style bg=colour235,fg=white #bg=base02
# # pane number display (i.e. q)
# set -g display-panes-style active-colour colour33 #blue
# set -g display-panes-colour colour166 #orange
# clock
# set-window-option -g clock-mode-colour colour64 #green
################################ Personal ##############################
## Plugins #############################################################
# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'
# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b '~/.tmux/plugins/tpm/tpm'
################################ End Personal ##########################
